<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="description" content="">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="keywords" content="">

 
<meta property="og:type" content="article"/>
<meta property="og:description" content=""/>
<meta property="og:title" content="Vba : spf13.com"/>
<meta property="og:site_name" content="spf13 is Steve Francia"/>
<meta property="og:image" content="" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="" />
<meta property="og:image:height" content="" />
<meta property="og:url" content="http://zhash.github.io/tags/vba/">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2016-03-24"/>
<meta property="article:modified_time" content="2016-03-24"/>





<meta name="twitter:card" content="summary">

<meta name="twitter:site" content="@spf13">
<meta name="twitter:title" content="Vba : spf13.com">
<meta name="twitter:creator" content="@spf13">
<meta name="twitter:description" content="">
<meta name="twitter:image:src" content="">
<meta name="twitter:domain" content="spf13.com">



    <base href="http://zhash.github.io">
    <title> Vba - merty </title>
    <link rel="canonical" href="http://zhash.github.io/tags/vba/">
    <link href="http://zhash.github.io/tags/vba/index.xml" rel="alternate" type="application/rss+xml" title="Vba" />

    <link href='http://fonts.googleapis.com/css?family=Fjalla+One|Open+Sans:300' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/static/css/style.css">

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
</head>

<body lang="en">
<header id="header">
    <figure>
      <a href="/" border=0 id="logolink"><div class="icon-spf13-3" id="logo"> </div></a>
    </figure>
    <div id="byline">by Merty</div>
    <nav id="nav">
            <ul id="mainnav">
            <li>
                <a href="/post/">
                <span class="icon"> <i aria-hidden="true" class="icon-quill"></i></span>
                <span> blog </span>
            </a>
            </li>
            <li>
            <a href="/project/">
                <span class="icon"> <i aria-hidden="true" class="icon-console"></i></span>
                <span> code </span>
            </a>
            </li>
            <li>
            <a href="/presentation/">
                <span class="icon"> <i aria-hidden="true" class="icon-stats"></i></span>
                <span> talks </span>
            </a>
            </li>
            <li>
            <a href="http://zhash.github.io/post">
                <span class="icon"> <i aria-hidden="true" class="icon-13"></i></span>
                <span> me </span>
            </a>
            </li>
        </ul>

            <ul id="social">
            <li id="share">
                <span class="icon icon-bubbles"> </span>
                <span class="title"> share </span>
                <div class="dropdown share">
                    <ul class="social">
                      <li> <a href="https://twitter.com/intent/tweet?status=Vba-http%3a%2f%2fzhash.github.io%2ftags%2fvba%2f" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                        <li> <a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fzhash.github.io%2ftags%2fvba%2f" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                        <li> <a href="https://plus.google.com/share?url=http%3a%2f%2fzhash.github.io%2ftags%2fvba%2f" target="_blank" title="Google+" class="googleplus"><span class="icon icon-google-plus"></span>Google+</a> </li>
                        <li> <a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fzhash.github.io%2ftags%2fvba%2f&title=Vba&source=spf13" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                        <li> <a href="http://del.icio.us/post?url=http%3a%2f%2fzhash.github.io%2ftags%2fvba%2f" target="_blank" title="Delicious" class="delicious"><span class="icon icon-delicious"></span>Delicious</a> </li>
                        <li> <a href="http://www.reddit.com/submit?url=http%3a%2f%2fzhash.github.io%2ftags%2fvba%2f" target="_blank" title="Reddit" class="reddit"><span class="icon icon-reddit"></span>Reddit</a> </li>
                        <li> <a href="http://www.stumbleupon.com/submit?url=http%3a%2f%2fzhash.github.io%2ftags%2fvba%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="icon icon-stumbleupon"></span>StumbleUpon</a> </li>
                    </ul>
                    <span class="subcount">sharing is caring</span>
                </div>
            </li>
            <li id="follow">
                <span class="icon icon-rocket"> </span>
                <span class="title"> follow </span>
                <div class="dropdown follow">
                    <ul class="social">
                        <li> <a href="http://feeds.feedburner.com/spf13" target="_blank" title="Subscribe by RSS" class="rss"><span class="icon icon-feed-2"></span>RSS</a> </li>
                        <li> <a href="http://www.twitter.com/spf13" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                        <li> <a href="http://www.facebook.com/stevefrancia" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                        <li> <a href="http://www.linkedin.com/in/stevefrancia" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                        <li> <a href="http://github.com/spf13" target="_blank" title="GitHub" class="github"><span class="icon icon-github"></span>GitHub</a> </li>
                        <li> <a href="http://gplus.to/spf13" target="_blank" title="Google+" class="googleplus"><span class="icon icon-google-plus"></span>Google+</a> </li>
                        <li> <a href="http://slideshare.com/spf13" target="_blank" title="SlideShare" class="slideshare"><span class="icon icon-slideshare"></span>SlideShare</a> </li>
                    </ul>
                    <span class="subcount">join 10k+ subscribers &amp; followers</span>
                </div>
            </li>
        </ul>

    </nav>
</header>


<section id="main">
  <div>
   <h1 id="title">Vba</h1>
    
        <article class="post">
    <header>
      <h2><a href="http://zhash.github.io/post/vba-design-pattern/">设计模式在Excel VBA 类中的基础应用 </a> </h2>
      <div class="post-meta">Thu, Mar 24, 2016 -  Read in 2 Min </div>
    </header>

    Design Pattern VBA 跟很多玩VBA朋友一样,对于VBA的类一直摸不着头脑,觉得它的应用貌似不如想象中的强大, 直到阅读了《设计模式》的相关书籍后,才有一点心得,分享如下,当然设计模式的思想概念 什么的不会再本文中展开叙述的. 同时关于VBA类的基础知识,这边也不赘述了,相关资料也 有许多. 看书的直接后果导致个人目前认为: 技术到最后,褪去华丽的技巧,剩下能闪烁的还是思想. Scene 个人在实际工作中运用最多的场景是:打开一个数据源,取出相关数据,根据不同的需求加工 整理后输出.针对上面的场景,我们来进行相关的设计,至于里面用到了哪种或哪些设计模式 大家有兴趣可以自行研究. 这里并非卖关子,只是想抛砖引玉,让大家保持好奇心,去深入了 解设计模式. 如果强行说要去弄类的各种属性,也只不过是把数据源中的各个标题字段搞一遍而已,貌似是 画蛇添足, 所以我一般不搞,直接就是上类的方法. DateSource 数据源的类型包括文本文件、excel文件、各种数据库(Access,Oracle,SqlServer&hellip;) 需要一个Open的方法来打开数据源,假定数据源是excel文件,OpenWorkBook() 数据源有时不只一个excel文件而是一批,需要一个数组存放数据源的名称,FileArray() 数据源需要一个存放路径,所以定义一个方法叫FolderPath() 打开数据源取完数后,我们要关闭数据源,CloseWorkbook() 通常还会定义一个方法用来释放程序过程中用到的对象FreeObj() Interface 根据以上的描述一个通用接口类的方法,基本上就都出来了,汇总如下: INormal 接口类的名称为:INormal Public Function OpenWorkbook() End Function Public Function FileArray() End Function Public Function CloseWorkbook() End Function Public Function FreeObj() End Function 以上有几点需要注意一下: 接口类的名称遵循惯例以I打头 接口中涉及的方法名称不要有下划线 据我的经验,如果接口方法名称中带下划线的话,在实现类中VBE不容易自动生成相关的实现方法名称 （这一点纯属个人经验,未经官方证实）. IChange INormal是打底的,还会需要另一个接口类, 这个接口类名称为IChange,具体包含以下方法: 打开数据源后,要取得相关的源数据,需要一个方法GetSource() 这些源数据取得后,要进行加工整理,定义一个方法TransSource() 加工整理完以后,要进行输出,所以定义一个方法FillSource() 整理如下: Public Function GetSource() End Function Public Function TransSource(Optional arr As Variant) End Function Public Function FillSource(Optional arr As Variant) End Function 至此两个接口类已设置完成 Object 现在来看实现类 Company 先建一个实现类,名称为Company,引用上面的两个接口 Implements INormal Implements IChange 首先实现接口类INormal的方法: Private Function INormal_OpenWorkbook() End Function Private Function INormal_FolderPath() End Function Private Function INormal_FileArray() End Function Private Function INormal_CloseWorkbook() End Function Private Function INormal_FreeObj() End Function 再实现IChange接口类的方法 Private Function IChange_GetSource() As Variant dim arr:dim brr() INormal_FolderPath arr = INormal_FileArray If IsArray(arr) Then For i = 0 To UBound(arr) INormal_OpenWorkbook arr(i) ...
    <footer>
        <a href='http://zhash.github.io/post/vba-design-pattern/'><nobr>Read more →</nobr></a>
    </footer>
</article>

    
  </div>
</section>

<aside id="meta"> </aside>

<footer>
    <div>
        <p>
            &copy; 2016 Merty.
        </p>
    </div>
</footer>
<script type="text/javascript">
    (function() {
        var j = function(a, b) {
            return window.getComputedStyle ? getComputedStyle(a).getPropertyValue(b) : a.currentStyle[b]
        };
        var k = function(a, b, c) {
            if (a.addEventListener) a.addEventListener(b, c, false);
            else a.attachEvent('on' + b, c)
        };
        var l = function(a, b) {
            for (key in b)
                if (b.hasOwnProperty(key)) a[key] = b[key];
            return a
        };
        window.fitText = function(d, e, f) {
            var g = l({
                'minFontSize': -1 / 0,
                'maxFontSize': 1 / 0
            }, f);
            var h = function(a) {
                var b = e || 1;
                var c = function() {
                    a.style.fontSize = Math.max(Math.min(a.clientWidth / (b * 10), parseFloat(g.maxFontSize)), parseFloat(g.minFontSize)) + 'px'
                };
                c();
                k(window, 'resize', c)
            };
            if (d.length)
                for (var i = 0; i < d.length; i++) h(d[i]);
            else h(d);
            return d
        }
    })();
    fitText(document.getElementById('title'), 1)
</script>
<script>
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-7131036-1', 'spf13.com');
    ga('require', 'linkid', 'linkid.js');
    ga('require', 'displayfeatures');
    ga('send', 'pageview');
</script>
</body>

</html>
